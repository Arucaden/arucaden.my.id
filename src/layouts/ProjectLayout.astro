---
import type { CollectionEntry } from 'astro:content';
import '../styles/global.css';
import ArticleContainer from '@components/ArticleContainer.astro';
import ProjectSidebar from '@components/Projects/ProjectSidebar.astro';

interface Props {
  content: CollectionEntry<'projects'>;
}

const { content } = Astro.props;
const { title, image, description, tech = [], publishDate, url } = content.data;
const { Content } = await content.render();
---

<article class="crt-bg-flat px-4 md:px-12 lg:px-24 pt-8 md:pt-12 min-h-screen mx-auto">
  <ArticleContainer title={title} description={description}>
    <!-- Mobile: Reorder the elements (image, then sidebar, then content) -->
    <div class="w-full max-w-full overflow-hidden block md:hidden">
      <!-- Image first on mobile -->
      <img 
        src={image} 
        alt={title} 
        class="image-border2 w-full object-cover aspect-video" 
      />
      
      <!-- Sidebar next on mobile -->
      <div class="mt-6 mb-6">
        <ProjectSidebar 
          title={title}
          tech={tech}
          url={url}
          sourceUrl={url}
        />
      </div>
      
      <!-- Content last on mobile -->
      <div class="text-sm text-white sm:text-base mt-4">
        <Content />
      </div>
    </div>
    
    <!-- Desktop: Standard layout (hidden on mobile) -->
    <div class="hidden md:block w-full max-w-full overflow-hidden">
      <img 
        src={image} 
        alt={title} 
        class="image-border2 w-full object-cover aspect-video" 
      />

      <div class="text-sm text-white sm:text-base mt-4">
        <Content />
      </div>
    </div>
    
    <!-- Only show divider on md screens and up -->
    <div class="hidden md:block bg-tertiary w-2px"></div>

    <!-- Only show this sidebar on desktop -->
    <div class="hidden md:block">
      <ProjectSidebar 
        title={title}
        tech={tech}
        url={url}
        sourceUrl={url}
      />
    </div>
  </ArticleContainer>
</article>

<style>
  :global(.prose pre) {
    max-width: 100%;
    overflow-x: auto;
  }
  
  :global(.prose img) {
    max-width: 100%;
    height: auto;
  }
  
  :global(.prose table) {
    display: block;
    overflow-x: auto;
  }
</style>