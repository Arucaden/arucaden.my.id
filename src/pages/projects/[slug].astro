---
import { getCollection } from 'astro:content';
import ProjectLayout from '@/layouts/ProjectLayout.astro';
import { projects as projectsData } from '@data/projects.ts';

// Define all possible routes at build time
export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map(entry => ({
    params: { slug: entry.slug },
    props: { 
      entry,
      projectData: projectsData[entry.slug] || {}
    }
  }));
}

const { entry, projectData } = Astro.props;

// Create a proper CollectionEntry structure
const enrichedEntry = {
  ...entry,
  data: {
    ...projectData,  // Start with projects.ts data
    ...entry.data,   // Override with any frontmatter data
  }
};
---

<ProjectLayout content={enrichedEntry} />